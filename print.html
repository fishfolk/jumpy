<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js navy">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Fish Fight Documentation</title>
        
        <meta name="robots" content="noindex" />
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="code_of_conduct.html"><strong aria-hidden="true">1.1.</strong> Code of Conduct</a></li></ol></li><li class="chapter-item expanded "><a href="gameplay.html"><strong aria-hidden="true">2.</strong> Gameplay</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="controls.html"><strong aria-hidden="true">2.1.</strong> Controls</a></li><li class="chapter-item expanded "><a href="items.html"><strong aria-hidden="true">2.2.</strong> Items</a></li><li class="chapter-item expanded "><a href="multiplayer.html"><strong aria-hidden="true">2.3.</strong> Multiplayer</a></li></ol></li><li class="chapter-item expanded "><a href="mechanics.html"><strong aria-hidden="true">3.</strong> Mechanics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="physics.html"><strong aria-hidden="true">3.1.</strong> Physics</a></li><li class="chapter-item expanded "><a href="environmental_weapons.html"><strong aria-hidden="true">3.2.</strong> Environmental Weapons</a></li></ol></li><li class="chapter-item expanded "><a href="netcode.html"><strong aria-hidden="true">4.</strong> Netcode</a></li><li class="chapter-item expanded "><a href="editor.html"><strong aria-hidden="true">5.</strong> Editor</a></li><li class="chapter-item expanded "><a href="contributing.html"><strong aria-hidden="true">6.</strong> Contributing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="contributing_code.html"><strong aria-hidden="true">6.1.</strong> Contributing Code</a></li><li class="chapter-item expanded "><a href="simple_gun_weapon.html"><strong aria-hidden="true">6.2.</strong> Simple Gun Weapon</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Fish Fight Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        <a href="https://github.com/fishfight/FishFight" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- markdownlint-disable MD041 -->
<h1><a class="header" href="#fish-fight" id="fish-fight">Fish Fight</a></h1>
<p><a href="https://github.com/fishfight/fish2/actions?query=workflow%3A"><img src="https://github.com/fishfight/fish2/workflows/Compilation%20check/badge.svg" alt="Github Actions" /></a>
<img src="https://user-images.githubusercontent.com/583842/132137745-ee1f4565-bd75-4d56-b040-234a259ed2b7.gif" alt="fish-scene" /></p>
<h2><a class="header" href="#introduction" id="introduction">Introduction</a></h2>
<p>Fish Fight is a tactical 2D shooter, played by up to 4 players online or on a shared screen. Aim either left or right; the rest is up to clever movement and positioning in this fish-on-fish brawler! For more information about our origin story (Duck Game et.al.) and big-picture plans, see our <a href="https://www.notion.so/erlendsh/Fish-Fight-1647ed74217e4e38a59bd28f4f5bc81a">design document</a>.</p>
<h3><a class="header" href="#key-features-wip" id="key-features-wip">Key Features (WIP)</a></h3>
<ul>
<li>2 to 4 players in either Local Multiplayer or Online Play</li>
<li>Easy to pick up, emphasizing strategy over twitch reaction</li>
<li>Customize characters with hats, saved to your cross-platform profile</li>
<li>Create &amp; explore user-made weapons, levels, audio and other scripted extensions</li>
<li>Smart level creation tools</li>
<li>Tournaments &amp; matchmaking built in</li>
</ul>
<h3><a class="header" href="#status" id="status">Status</a></h3>
<p>The game is fully playable: <br />
https://twitter.com/fishfightgame/status/1424084016467226624</p>
<h2><a class="header" href="#community" id="community">Community</a></h2>
<h3><a class="header" href="#contributing" id="contributing">Contributing</a></h3>
<p>Anyone involved in the Fish Fight community must follow our <a href="https://github.com/fishfight/FishFight/blob/main/CODE_OF_CONDUCT.md">code of conduct</a>.</p>
<p>If you'd like to make something for Fish Fight, check out our <a href="https://github.com/fishfight/FishFight/labels/help%20wanted">help-wanted</a> issues or just ask us on <a href="https://discord.gg/4smxjcheE5">Discord</a>. We'll soon post an updated roadmap for the next month or two of work ahead.</p>
<p>Before committing and opening a PR, please run the following commands and follow their instructions:</p>
<ol>
<li><code>cargo clippy -- -W clippy::correctness -D warnings</code></li>
<li><code>cargo fmt</code></li>
</ol>
<h3><a class="header" href="#learning-materials" id="learning-materials">Learning Materials</a></h3>
<ul>
<li>https://macroquad.rs/tutorials/fish-tutorial/</li>
<li>https://not-fl3.github.io/platformer-book/intro.html</li>
<li>https://sokoban.iolivia.me/ (we do not use an ECS)</li>
<li>https://pragprog.com/titles/hwrust/hands-on-rust/</li>
</ul>
<h2><a class="header" href="#install--play" id="install--play">Install &amp; play</a></h2>
<ol>
<li>Install Rust with <a href="https://rustup.rs/">Rustup.rs</a></li>
<li><code>cargo run</code></li>
</ol>
<p>We'll start distributing executables shortly!</p>
<h2><a class="header" href="#default-key-bindings" id="default-key-bindings">Default key bindings</a></h2>
<p>Keyboard left:</p>
<ul>
<li>movement: arrow keys <code>↑</code>, <code>←</code>, <code>↓</code>, <code>→</code></li>
<li>pick/drop: <code>K</code></li>
<li>attack: <code>L</code></li>
<li>toggle AI: <code>0</code></li>
</ul>
<p>Keyboard right:</p>
<ul>
<li>movement: <code>W</code>, <code>A</code>, <code>S</code>, <code>D</code> (&amp; <code>Space</code> for jump)</li>
<li>pick/drop: <code>C</code></li>
<li>attack: <code>V</code> &amp; <code>LeftCtrl</code></li>
<li>toogle AI: <code>1</code></li>
</ul>
<p>Gamepad:</p>
<ul>
<li>movement: direction axis</li>
<li>pick/drop: <code>X</code></li>
<li>attack: <code>B</code></li>
<li>jump: <code>A</code></li>
<li>slide: <code>Down</code> + <code>Y</code></li>
</ul>
<h2><a class="header" href="#credits" id="credits">Credits</a></h2>
<ul>
<li>Input Icons: <a href="https://kadith.itch.io/kadiths-free-icons">Kadith's Icons</a> by Kadith</li>
</ul>
<!-- markdownlint-disable MD041 -->
<h1><a class="header" href="#contributor-covenant-code-of-conduct" id="contributor-covenant-code-of-conduct">Contributor Covenant Code of Conduct</a></h1>
<h2><a class="header" href="#our-pledge" id="our-pledge">Our Pledge</a></h2>
<p>We as members, contributors, and leaders pledge to make participation in our
community a harassment-free experience for everyone, regardless of age, body
size, visible or invisible disability, ethnicity, sex characteristics, gender
identity and expression, level of experience, education, socio-economic status,
nationality, personal appearance, race, religion, or sexual identity
and orientation.</p>
<p>We pledge to act and interact in ways that contribute to an open, welcoming,
diverse, inclusive, and healthy community.</p>
<h2><a class="header" href="#our-standards" id="our-standards">Our Standards</a></h2>
<p>Examples of behavior that contributes to a positive environment for our
community include:</p>
<ul>
<li>Demonstrating empathy and kindness toward other people</li>
<li>Being respectful of differing opinions, viewpoints, and experiences</li>
<li>Giving and gracefully accepting constructive feedback</li>
<li>Accepting responsibility and apologizing to those affected by our mistakes,
and learning from the experience</li>
<li>Focusing on what is best not just for us as individuals, but for the
overall community</li>
</ul>
<p>Examples of unacceptable behavior include:</p>
<ul>
<li>The use of sexualized language or imagery, and sexual attention or
advances of any kind</li>
<li>Trolling, insulting or derogatory comments, and personal or political attacks</li>
<li>Public or private harassment</li>
<li>Publishing others' private information, such as a physical or email
address, without their explicit permission</li>
<li>Other conduct which could reasonably be considered inappropriate in a
professional setting</li>
</ul>
<h2><a class="header" href="#enforcement-responsibilities" id="enforcement-responsibilities">Enforcement Responsibilities</a></h2>
<p>Community leaders are responsible for clarifying and enforcing our standards of
acceptable behavior and will take appropriate and fair corrective action in
response to any behavior that they deem inappropriate, threatening, offensive,
or harmful.</p>
<p>Community leaders have the right and responsibility to remove, edit, or reject
comments, commits, code, wiki edits, issues, and other contributions that are
not aligned to this Code of Conduct, and will communicate reasons for moderation
decisions when appropriate.</p>
<h2><a class="header" href="#scope" id="scope">Scope</a></h2>
<p>This Code of Conduct applies within all community spaces, and also applies when
an individual is officially representing the community in public spaces.
Examples of representing our community include using an official e-mail address,
posting via an official social media account, or acting as an appointed
representative at an online or offline event.</p>
<h2><a class="header" href="#enforcement" id="enforcement">Enforcement</a></h2>
<p>Instances of abusive, harassing, or otherwise unacceptable behavior may be
reported to the community leaders responsible for enforcement at
e.soghe@gmail.com.
All complaints will be reviewed and investigated promptly and fairly.</p>
<p>All community leaders are obligated to respect the privacy and security of the
reporter of any incident.</p>
<h2><a class="header" href="#enforcement-guidelines" id="enforcement-guidelines">Enforcement Guidelines</a></h2>
<p>Community leaders will follow these Community Impact Guidelines in determining
the consequences for any action they deem in violation of this Code of Conduct:</p>
<h3><a class="header" href="#1-correction" id="1-correction">1. Correction</a></h3>
<p><strong>Community Impact</strong>: Use of inappropriate language or other behavior deemed
unprofessional or unwelcome in the community.</p>
<p><strong>Consequence</strong>: A private, written warning from community leaders, providing
clarity around the nature of the violation and an explanation of why the
behavior was inappropriate. A public apology may be requested.</p>
<h3><a class="header" href="#2-warning" id="2-warning">2. Warning</a></h3>
<p><strong>Community Impact</strong>: A violation through a single incident or series
of actions.</p>
<p><strong>Consequence</strong>: A warning with consequences for continued behavior. No
interaction with the people involved, including unsolicited interaction with
those enforcing the Code of Conduct, for a specified period of time. This
includes avoiding interactions in community spaces as well as external channels
like social media. Violating these terms may lead to a temporary or
permanent ban.</p>
<h3><a class="header" href="#3-temporary-ban" id="3-temporary-ban">3. Temporary Ban</a></h3>
<p><strong>Community Impact</strong>: A serious violation of community standards, including
sustained inappropriate behavior.</p>
<p><strong>Consequence</strong>: A temporary ban from any sort of interaction or public
communication with the community for a specified period of time. No public or
private interaction with the people involved, including unsolicited interaction
with those enforcing the Code of Conduct, is allowed during this period.
Violating these terms may lead to a permanent ban.</p>
<h3><a class="header" href="#4-permanent-ban" id="4-permanent-ban">4. Permanent Ban</a></h3>
<p><strong>Community Impact</strong>: Demonstrating a pattern of violation of community
standards, including sustained inappropriate behavior,  harassment of an
individual, or aggression toward or disparagement of classes of individuals.</p>
<p><strong>Consequence</strong>: A permanent ban from any sort of public interaction within
the community.</p>
<h2><a class="header" href="#attribution" id="attribution">Attribution</a></h2>
<p>This Code of Conduct is adapted from the <a href="https://www.contributor-covenant.org">Contributor Covenant</a>,
version 2.0, available at
https://www.contributor-covenant.org/version/2/0/code_of_conduct.html.</p>
<p>Community Impact Guidelines were inspired by <a href="https://github.com/mozilla/diversity">Mozilla's code of conduct
enforcement ladder</a>.</p>
<p>For answers to common questions about this code of conduct, see the FAQ at
https://www.contributor-covenant.org/faq. Translations are available at
https://www.contributor-covenant.org/translations.</p>
<h1><a class="header" href="#gameplay" id="gameplay">Gameplay</a></h1>
<h1><a class="header" href="#controls" id="controls">Controls</a></h1>
<h2><a class="header" href="#keyboard-right" id="keyboard-right">Keyboard Right</a></h2>
<table><thead><tr><th align="center">Key</th><th align="center"></th><th align="center">Action</th></tr></thead><tbody>
<tr><td align="center">Up</td><td align="center"><img src="assets/up_key.gif" alt="up_key" /></td><td align="center">Jump</td></tr>
<tr><td align="center">Down</td><td align="center"><img src="assets/down_key.gif" alt="down_key" /></td><td align="center">Crouch</td></tr>
<tr><td align="center">Left</td><td align="center"><img src="assets/left_key.gif" alt="left_key" /></td><td align="center">Move left</td></tr>
<tr><td align="center">Right</td><td align="center"><img src="assets/right_key.gif" alt="right_key" /></td><td align="center">Move right</td></tr>
<tr><td align="center">K</td><td align="center"><img src="assets/k_key.gif" alt="k_key" /></td><td align="center">Pickup/Drop</td></tr>
<tr><td align="center">L</td><td align="center"><img src="assets/l_key.gif" alt="l_key" /></td><td align="center">Attack</td></tr>
<tr><td align="center">0</td><td align="center"><img src="assets/0_key.gif" alt="0_key" /></td><td align="center">Toggle AI</td></tr>
</tbody></table>
<h2><a class="header" href="#keyboard-left" id="keyboard-left">Keyboard Left</a></h2>
<table><thead><tr><th align="center">Key</th><th align="center"></th><th align="center">Action</th></tr></thead><tbody>
<tr><td align="center">W</td><td align="center"><img src="assets/w_key.gif" alt="w_key" /></td><td align="center">Jump</td></tr>
<tr><td align="center">S</td><td align="center"><img src="assets/s_key.gif" alt="s_key" /></td><td align="center">Crouch</td></tr>
<tr><td align="center">A</td><td align="center"><img src="assets/a_key.gif" alt="a_key" /></td><td align="center">Move left</td></tr>
<tr><td align="center">D</td><td align="center"><img src="assets/d_key.gif" alt="d_key" /></td><td align="center">Move right</td></tr>
<tr><td align="center">C</td><td align="center"><img src="assets/c_key.gif" alt="c_key" /></td><td align="center">Pickup/Drop</td></tr>
<tr><td align="center">V</td><td align="center"><img src="assets/v_key.gif" alt="v_key" /></td><td align="center">Attack</td></tr>
<tr><td align="center">1</td><td align="center"><img src="assets/1_key.gif" alt="1_key" /></td><td align="center">Toggle AI</td></tr>
</tbody></table>
<h2><a class="header" href="#gamepad" id="gamepad">Gamepad</a></h2>
<table><thead><tr><th align="center">Input</th><th align="center"></th><th align="center">Action</th></tr></thead><tbody>
<tr><td align="center">A Button</td><td align="center"><img src="assets/a_button.gif" alt="a_button" /></td><td align="center">Jump</td></tr>
<tr><td align="center">Y Button</td><td align="center"><img src="assets/y_button.gif" alt="y_button" /></td><td align="center">Crouch</td></tr>
<tr><td align="center">Left Thumbstick</td><td align="center"><img src="assets/left_thumb.gif" alt="left_thumb" /></td><td align="center">Move left</td></tr>
<tr><td align="center">Right Thumbstick</td><td align="center"><img src="assets/right_thumb.gif" alt="right_thumb" /></td><td align="center">Move right</td></tr>
<tr><td align="center">X Button</td><td align="center"><img src="assets/x_button.gif" alt="x_button" /></td><td align="center">Pickup/Drop</td></tr>
<tr><td align="center">B Button</td><td align="center"><img src="assets/b_button.gif" alt="b_button" /></td><td align="center">Attack</td></tr>
</tbody></table>
<h1><a class="header" href="#items" id="items">Items</a></h1>
<p>Items are placed in levels and can be interacted with by players.</p>
<table><thead><tr><th align="center">Name</th><th align="center"></th><th align="center">Description</th></tr></thead><tbody>
<tr><td align="center">Musket</td><td align="center"><img src="assets/musket.png" alt="musket" /></td><td align="center">Fires up to three bullets, normal recoil, normal bullet speed.</td></tr>
<tr><td align="center">Sniper</td><td align="center"><img src="assets/sniper.png" alt="sniper" /></td><td align="center">Fires up to two bullets, high recoil, high bullet speed.</td></tr>
<tr><td align="center">Machine Gun</td><td align="center"><img src="assets/machine_gun.png" alt="machine_gun" /></td><td align="center">Fires many bullets, low recoil, normal bullet speed.</td></tr>
<tr><td align="center">Cannon</td><td align="center"><img src="assets/cannon.png" alt="cannon" /></td><td align="center">Fires up to three bombs, normal recoil.</td></tr>
<tr><td align="center">Turtle Shell</td><td align="center"><img src="assets/turtle_shell.png" alt="turtle_shell" /></td><td align="center">Blocks two attacks from behind, then breaks.</td></tr>
<tr><td align="center">Shoes</td><td align="center"><img src="assets/shoes.png" alt="shoes" /></td><td align="center">Allows user to attack players by jumping on their heads.</td></tr>
<tr><td align="center">Galleon</td><td align="center"><img src="assets/galleon.png" alt="galleon" /></td><td align="center">Summons a galleon that travels across the arena. Kills anything in its path.</td></tr>
<tr><td align="center">Volcano</td><td align="center"><img src="assets/volcano.png" alt="volcano" /></td><td align="center">Summons a volcano that randomly shoots bombs into the arena.</td></tr>
<tr><td align="center">Shark Rain</td><td align="center"><img src="assets/shark_rain.png" alt="shark_rain" /></td><td align="center">Summons sharks that rain down from above. Kills anything in their path.</td></tr>
<tr><td align="center">Grenades</td><td align="center"><img src="assets/grenades.png" alt="grenades" /></td><td align="center">Throws up to three bombs that explode after short duration or on impact.</td></tr>
<tr><td align="center">Mines</td><td align="center"><img src="assets/mines.png" alt="mines" /></td><td align="center">Place up to three mines that explode on contact.</td></tr>
<tr><td align="center">Jellyfish</td><td align="center"><img src="assets/jellyfish.png" alt="jellyfish" /></td><td align="center">Fires a jellyfish that is controlled by the player and explodes impact.</td></tr>
<tr><td align="center">Sproinger</td><td align="center"><img src="assets/sproinger.png" alt="sproinger" /></td><td align="center">Bounces player when jumped on.</td></tr>
</tbody></table>
<h1><a class="header" href="#multiplayer" id="multiplayer">Multiplayer</a></h1>
<p>Connection process in the FishFight is extremely low-level right now.<br />
We do not have matchmaking server and we want to collect data and network setups and possible problems before doing the process fully automatic.</p>
<p><img src="https://user-images.githubusercontent.com/910977/133952684-19e7f10a-ed80-49e6-8a31-205f28a78c39.png" alt="image" /></p>
<p>The only supported game mode right now: 1v1.</p>
<h2><a class="header" href="#connection-types" id="connection-types">Connection Types</a></h2>
<h3><a class="header" href="#lan" id="lan">LAN</a></h3>
<p>When both computers are connected to the same router: are on the same wifi, home network etc.</p>
<p>Send your local IP from &quot;Self addr&quot; field to your opponent, click &quot;Probe connection&quot; and if connection can be established - click &quot;Connect&quot;.</p>
<h3><a class="header" href="#stun" id="stun">STUN</a></h3>
<p>When each player is under a NAT. Usually when its two players over internet with different network providers.
This option may work, but may not, it depends on the type of nat, router configs etc.</p>
<p>Idea is exactly the same as with LAN: copy-paste your own &quot;Self addr&quot; over discord, probe connection, if it works - click &quot;Connect&quot;</p>
<h3><a class="header" href="#relay" id="relay">Relay</a></h3>
<p>When both players are on remote computers over internet, but STUN connection did not worked and router reconfiguration is not an option - there is a relay server available.</p>
<p>Relay server will introduce additional LAG - each packet will be forwarded through a server.</p>
<p>Connection idea is still the same, but instead of IP &quot;Self addr&quot; will be an ID on the relay server. Copy-paste it over internet, set &quot;Opponent addr&quot;, push &quot;Connect&quot;</p>
<h2><a class="header" href="#router-configuration" id="router-configuration">Router Configuration</a></h2>
<p>When STUN server failed, but Relay is too slow - there is a way to improve gameplay experience. Go to router settings and forward ports 3400, 3401, 3402, 3403 to computer with the FishFight.</p>
<p>It still may depend on the internet provider, maybe the router itself is behind some global, provider NAT or something.</p>
<p>TODO: Make a better &quot;Router configuration&quot; section here.</p>
<h1><a class="header" href="#mechanics" id="mechanics">Mechanics</a></h1>
<h1><a class="header" href="#physics" id="physics">Physics</a></h1>
<p>As you might already know, Fish Fight is a homage to the excellent Duck Game and thus we have chosen to replicate the rather simple and straight forward linear physics found in that game. It follows standard platformer physics, with force being translated to two-dimensional velocity, acting against gravity and drag, every physics update (<code>fixed_update</code>).</p>
<p><a href="https://maddythorson.medium.com/celeste-and-towerfall-physics-d24bd2ae0fc5">The same physics system is used in Towerfall and Celeste.</a></p>
<p>To learn more about basic game physics, as they are implemented in Fish Fight, you can explore the following sources:</p>
<p><code>[Ask us about missing links!]</code></p>
<h2><a class="header" href="#fish-fights-physics-implementation" id="fish-fights-physics-implementation">Fish Fight's physics implementation</a></h2>
<p>As for the specifics of Fish Fight, I will elaborate in the following paragraphs. Please note, however, that the game is currently in a very early prototype stage, so the implementation is neither perfect nor, in any way, optimized, at this stage.</p>
<h3><a class="header" href="#scene-nodes" id="scene-nodes">Scene nodes</a></h3>
<p>The game uses the <a href="https://github.com/not-fl3/macroquad">Macroquad library</a>, by <a href="https://github.com/not-fl3">Fedor</a>, who is also part of the core team of Fish Fight. This means that our scenes are composed of scene nodes, made by implementing the <code>Node</code> type. The most relevant method, when discussing physics, is the <code>fixed_update</code> method, which is called for every node, every physics frame. This means that, in order to explore the existing physics of any existing in-game object, you should browse to the corresponding node source file, in <a href="https://github.com/fishfight/fish2/tree/master/src/nodes"><code>src/nodes</code></a>, and look for the <code>impl Node for T</code> section and the encapsulated <code>fixed_update</code> implementation.</p>
<p>This method takes a <code>RefMut&lt;T&gt;</code> as an argument (can be both mutable and immutable), where <code>T</code> is the type of the node that it is being implemented for. From here, you can do many things; like manipulating the node, itself, through the <code>RefMut&lt;T&gt;</code> parameter, as well as access other nodes by fetching them from the scene, either by type, or by specific traits, made by calling <code>node.provides([...])</code> in a nodes <code>ready</code> implementation. For examples of this, you can check the code of most nodes for the code providing the <code>Sproingable</code> trait, for example.</p>
<p>Examples of code for accessing other nodes:</p>
<pre><pre class="playpen"><code class="language-rust">
<span class="boring">#![allow(unused_variables)]
</span><span class="boring">fn main() {
</span>// This is from the ArmedGrenade node, showing how we iterate over players, checking for
// collision and killing the player if the explosion &quot;collides&quot; with the player
for mut player in scene::find_nodes_by_type::&lt;crate::nodes::Player&gt;() {
    let intersect =
        grenade_rect.intersect(Rect::new(
            player.body.pos.x,
            player.body.pos.y,
            PLAYER_HITBOX_WIDTH,
            PLAYER_HITBOX_HEIGHT,
        ));
    if !intersect.is_none() {
        let direction = node.body.pos.x &gt; (player.body.pos.x + 10.);
        scene::find_node_by_type::&lt;crate::nodes::Camera&gt;()
            .unwrap()
            .shake();
        player.kill(direction);
    }
}
<span class="boring">}
</span></code></pre></pre>
<pre><pre class="playpen"><code class="language-rust">
<span class="boring">#![allow(unused_variables)]
</span><span class="boring">fn main() {
</span>// This is from the Sproinger node, iterating through nodes providing the Sproingable trait
// and checking for collision, before performing a &quot;sproing&quot; on them, if they overlap
for (_actor, mut body_lens, size) in scene::find_nodes_with::&lt;Sproingable&gt;() {
    if body_lens.get().is_some() {
        let body = body_lens.get().unwrap();
        if body.speed.length() &gt; Self::STOPPED_THRESHOLD {
            let intersect = sproinger_rect
                .intersect(Rect::new(body.pos.x, body.pos.y, size.x, size.y));
            if !intersect.is_none() {
                let resources = storage::get_mut::&lt;Resources&gt;();
                play_sound_once(resources.jump_sound);

                body.speed.y = -Self::FORCE;
                node.has_sproinged = true;
                // self.sprite.set_animation(1);
                // self.sprite.playing = true;
                Sproinger::animate(node.handle());
            }
        }
    }
}
<span class="boring">}
</span></code></pre></pre>
<h3><a class="header" href="#collision" id="collision">Collision</a></h3>
<p>Collision between nodes is done by creating collider <code>Rect</code> or <code>Circle</code> objects and calling their <code>intersect</code> (<code>Rect</code> only) or <code>overlaps</code> methods. The former will return an<code>Option&lt;Rect&gt;</code>, where the contained <code>Rect</code> represents the intersection between the two colliding <code>Rect</code> objects, or <code>None</code>, if there was no intersection. The latter will return a <code>bool</code> that is <code>true</code> if there was any overlap between the two objects. To check for collisions with the map, you have several methods in the <code>scene</code> module that lets you check for collisions on the various map layers. For examples of map collisions, once again, the <a href="https://github.com/fishfight/fish2/tree/master/src/nodes/player.rs"><code>Player</code></a> implementation is a good place to start. Furthermore, <code>PhysicsBody</code> members may hold a collider that Macroquads physics engine will collide against <code>Solid</code> objects in the scene (ground tiles, for the most part). These colliders will have to be added to the collision world, as actors. See the constructor of the <a href="https://github.com/fishfight/fish2/tree/master/src/nodes/player.rs"><code>player node</code></a> for an example of how this is done.</p>
<p>NOTE: To get the hitbox of a Player node, use <code>Player::get_hitbox()</code>, so that you get the correct size if the player node, for example, is in a crouched state.</p>
<h3><a class="header" href="#force" id="force">Force</a></h3>
<p>When it comes to enacting force on nodes, this is done by setting a speed on a node. Most nodes will have a body, but not all, as the primary use for a body is to hold a collider. For simpler nodes, we might just put a position vector and a speed vector directly on the node, in stead. This can be checked in the specific nodes implementation. As mentioned, we set the velocity directly, in stead of accumulating force over several frames, as this leads to much more predictable and precise game physics (the age old Mario, using acceleration, vs Megaman, using binary force, dichotomy).</p>
<p>This means that, in order to implement an explosion, for example, you would decide on a force, find the node(s) that the explosion will act upon and apply this force by setting the speed of the node, or the nodes body, depending on its implementation, to the value of the force in the appropriate direction. See below for a simplified example of something exerting a force, on the x-axis, on a player, if an arbitrary hit check condition is fulfilled:</p>
<pre><pre class="playpen"><code class="language-rust">
<span class="boring">#![allow(unused_variables)]
</span><span class="boring">fn main() {
</span>impl T {
    pub const FORCE: f32 = 900.0;
}

impl Node for T {
    for mut player in scene::find_nodes_by_type::&lt;crate::nodes::Player&gt;() {
        [hit detection]
        if is_hit {
            let direction_is_right = node.body.pos.x &gt; (player.body.pos.x + 10.);
            player.body.speed.x = if direction_is_right {
                FORCE
            } else {
                -FORCE // negative force
            }
        }
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>The same methods would be used for movement, for example, but instead of checking for a collision, you would check for input. For examples of this, check out the <a href="https://github.com/fishfight/fish2/tree/master/src/nodes/player.rs"><code>player node implementation</code></a>.</p>
<h1><a class="header" href="#environmental-weapons" id="environmental-weapons">Environmental weapons</a></h1>
<ul>
<li><a href="environmental_weapons.html#environmental-weapons">Environmental weapons</a>
<ul>
<li><a href="environmental_weapons.html#document-notes">Document notes</a></li>
<li><a href="environmental_weapons.html#mechanics-and-examples">Mechanics and examples</a></li>
<li><a href="environmental_weapons.html#code-design">Code design</a></li>
</ul>
</li>
</ul>
<p>Environmental weapons are weapons that don't follow the structure of weapon and projectile, rather, they spawn one or more entities intended to harm enemy.</p>
<h2><a class="header" href="#document-notes" id="document-notes">Document notes</a></h2>
<p>This document doesn't explain all the concepts, since some are already explained in <a href="physics.html">Physics</a>.</p>
<p><code>EW</code> is used as abbreviation for <code>E</code>nvironmental <code>W</code>eapon.</p>
<h2><a class="header" href="#mechanics-and-examples" id="mechanics-and-examples">Mechanics and examples</a></h2>
<p>For each pickup, it's possible to spawn the weapon only once; after usage, most will disappear entirely from the level.</p>
<p>Currently, there are a few EWs:</p>
<ul>
<li>Curse: a skull that chases the closest enemy, in a sinusoidal motion, for a limited amount of time;</li>
<li>Galleon: a large vessel that crosses the screen horizontally;</li>
<li>Shark rain: a group of sharks falling vertically from the top, at random horizontal positions.</li>
</ul>
<p>EWs may, or may not, self-pwn the owner.</p>
<h2><a class="header" href="#code-design" id="code-design">Code design</a></h2>
<p>EWs are typically designed in two main types: the item, which is what the player can pick up/hold/throw, and the weapon itself, which is the set of entities that are summoned and harm the enemies.</p>
<p>The general design is very similar to all the other weapons, with a few distinctions.</p>
<p>The <code>shoot()</code> routine, itself common to the other weapons, is a good starting point:</p>
<pre><code class="language-rs">pub fn shoot(galleon: Handle&lt;Galleon&gt;, player: Handle&lt;Player&gt;) -&gt; Coroutine {
    let coroutine = async move {
        /* ... */

        if galleon.used {
            player.state_machine.set_state(Player::ST_NORMAL);
            return;
        }

        galleon.used = true;

        FlyingGalleon::spawn(player.id);

        player.weapon = None;
        
        /* ... */

        galleon.delete();

        player.state_machine.set_state(Player::ST_NORMAL);
    };

    start_coroutine(coroutine)
}
</code></pre>
<p>A very important concept is that we must avoid race conditions on multiple shots. Since shooting is asynchronous, on the first shot, we need to set a flag (in this case, <code>used</code>) that makes other concurrent executions return.</p>
<p>Most EWs are usable only once per level; this is implemented by removing the weapon from the player (see above), and deleting the item from the node graph.</p>
<p>Since most of the EWs don't kill the owner, we store the Player id in the spawned type, and skip it on collision test:</p>
<pre><code class="language-rs">pub struct FlyingGalleon {
    /* ... */
    owner_id: u8,
}

impl scene::Node for FlyingGalleon {
    fn fixed_update(mut flying_galleon: RefMut&lt;Self&gt;) {
        /* ... */

        for mut player in scene::find_nodes_by_type::&lt;crate::nodes::Player&gt;() {
            if player.dead {
                continue;
            }

            if flying_galleon.owner_id != player.id {
                /* Collision test here */
</code></pre>
<p>We also check if a player is dead, before performing the the collision check: since the EWs are generally large, performing the test multiple times is not correct; for example, it has the immediate effect of causing multiple death effects.</p>
<p>EWs typically need to know the boundaries of the map; see the <code>FlyingGalleon#start_position_data()</code> routine:</p>
<pre><code class="language-rs">fn start_position_data() -&gt; (Vec2, bool) {
    let resources = storage::get::&lt;Resources&gt;();

    // We query the map size from the raw tiled map data:

    let map_width =
        resources.tiled_map.raw_tiled_map.tilewidth * resources.tiled_map.raw_tiled_map.width;
    let map_height =
        resources.tiled_map.raw_tiled_map.tileheight * resources.tiled_map.raw_tiled_map.height;

    // Note also how we generate a random boolean via MacroQuad `rand` APIs:

    let (start_x, direction) = if gen_range(0., 1.) &lt; 0.5 {
        (0. - FLYING_GALLEON_WIDTH, true)
    } else {
        ((map_width - 1) as f32, false)
    };

    let start_y = gen_range(0., map_height as f32 - FLYING_GALLEON_HEIGHT);

    (vec2(start_x, start_y), direction)
}
</code></pre>
<h1><a class="header" href="#netcode" id="netcode">Netcode</a></h1>
<p>The netcode in <a href="https://github.com/fishfight/FishFight">Fish Fight</a> is something called delay-based netcode by many players, but is more  specifically deterministic lockstep. A peer-to-peer architecture that is completely deterministic.</p>
<p>This video was the main inspiration for our netcode architecture:</p>
<iframe src="https://www.youtube.com/embed/7jb0FOcImdg" allowfullscreen="" width="500" height="281" frameborder="0"></iframe>
<p>What is described from 6:09 to 7:15 is the current state of our  netcode. The video proceeds to explain the limitations of this approach  and how they iterated from there to what can more accurately be called <a href="https://en.wikipedia.org/wiki/GGPO">GGPO</a>. That is where we are headed as well, beginning with a minimal  foundation that we have a full grasp and agency over. From the  intentionally naive “Player Unhappy” model we will gradually work our  way towards “Player Very Happy”.</p>
<h2><a class="header" href="#terms-and-concepts" id="terms-and-concepts">Terms and Concepts</a></h2>
<p>Before we go any further, let’s explain some terms and concepts.</p>
<p>First off, what makes online multiplayer games difficult to make?  There are two main issues: (1) The latency (travel time) for information over the internet, and (2) when circumventing that, ensuring that  nobody can cheat while also fairly integrating everyone’s input. What’s  important isn’t that the solution is ”correct”, but that it feels great  to your players. Game networking consists largely of clever tricks and  smoke and mirrors, all to disguise the inherent limits of space-time.</p>
<p>A peer/client is someone who joins an online game session. (We will  use these terms interchangeably, but there might be reasons to  differentiate the two). For example, when you play Minecraft, you join  servers as a client. Most games these days use a server-client  architecture, where clients will join a server that handles everything  in the online game session, and streams necessary data to the clients.</p>
<p>However, this isn’t the only way of handling things. Indeed, before  the server-client architecture became commonplace, there was the  peer-to-peer (P2P) architecture. Instead of relying on an authoritative  server to tell the clients what’s happening, the peers instead tell EACH OTHER what is happening. This means that any one peer has to send out  data to every single other peer, and as such the required bandwidth  scales linearly as more players join. For this reason most games just  use the server-client system for anything more than 6-8 players.  However, for a game like Fish Fight which will only have 2-4 players in  any one given match, a peer-to-peer system will make more sense.</p>
<p>This has several benefits. First and foremost, there’s no need to pay for hosting. While for a small project like Fish Fight, with a  relatively simple simulation, that cost would likely be low. But there’s a plethora of problems that must be addressed: that cost isn’t zero and still has to be paid somehow, and if the game gets immensely popular  the price will quickly skyrocket. And then you must also write a load  distribution system, and DDOS protection, the list goes on. A  peer-to-peer architecture offloads all the costs to the players, who are in any case already running the simulation. This also means that you  don’t need to maintain two separate client and server codebases, that  must exactly line up in behaviour. Peer-to-peer might even offer lower  latency, since the packets don’t have to go back and forth through a  server.</p>
<p>This is because hosting servers is EXPENSIVE. For example, hosting a  Minecraft server on Minecraft Realms is $8 dollars per month. That’s not much, but it's only one session. If we assume that this will “only”  have a max player count of 40 people per day, that means we have to host 10 servers. That means $80 dollars per month. This doesn’t even take  into account all of the other things we might have to worry about when  developing a server-client architecture, like having to maintain two  different codebases at the same time.</p>
<p>As such, making a peer-to-peer game makes sense at this scale.  However, any one who wants to make an online multiplayer game MUST  understand that every multiplayer solution is specialized to your  use-case. The server-client architecture has many other benefits, mainly scalability. But also, in Fish Fight there is no persistent state or  complex systems that must always be online. The ”servers” in P2P go  offline as soon as a player quits.</p>
<p>The Authority is whoever decides what is true, and can overwrite  anyone else’s state. The authority isn’t necessarily one party, but  rather authority is held over singular objects or values. For example, a player might hold authority over a ball they are kicking, so they don’t have to ask the server for confirmation before interacting resulting in a snappier experience. This isn’t exactly applicable in a lockstep P2P  architecture, but is foundational for client-servers so you’ll likely  see the term if you ever read anything about networking. In those cases  the server is almost always the authority, so the players can’t cheat.</p>
<p>Listen Servers are a network architecture/topology not to be confused with peer-to-peer. It is simply a client-server architecture where one  of the clients hosts the server. This combines the cost benefits of a  P2P topology while also allowing for better lag compensation methods. It still requires the same bandwidth as P2P, but only for the client who  is running the server so the game is no longer capped by the slowest  connection. Fish Fight might eventually move to this topology or move to a P2P model.</p>
<p>Ping/Latency/Round Trip Time all relate to the time it takes for a  message to travel over a network. Latency is the time it takes to travel from the sender to the recipient, while Round Trip Time (RTT) and Ping  refers to the time it takes both back and forth. RTT however is not  necessarily twice the latency, although often very close. On the  network, different conditions and even routes means that times will  vary.</p>
<p>Jitter is related to latency, and is the amount by which it varies. A bad connection does not only have long latency, but the time it takes  for packets to arrive will also vary greatly. This is a major hindrance  when you want data to arrive in a smooth and regular manner, such as  frames in a video, sound in a voice chat or input for a player. This is  managed by adding a Buffer, which stores values for a short while and  then dispenses them like an even flow. The tradeoff is that the fastest  packets are slowed down to be in time with the slowest packets, leading  to an overall slowdown.</p>
<p>Then there’s Packet Loss, where a packet gets completely lost at some crossroad of the internet. Bad connections also means that not all  packets will arrive. This is countered by adding Redundancy. Common ways to compensate is to send packets multiple times, so at least one is  likely to arrive, or send a confirmation once a packet is received. If  the confirmation is not received, resend the packet until you get a  response.</p>
<p>For some slightly more low-level things that you can do without:</p>
<p>TCP/UDP relates to packet loss. UDP is a transport protocol on the IP stack that “simply” sends messages, fire-and-forget, with no regard to  whether it arrives. TCP on the other hand has more overhead but  guarantees that your messages arrive. FishFight uses UDP for speed, and  implements a custom redundancy layer on top of that for extra  performance. TCP is often overkill, and a custom built solution almost  always works better since it can exploit the exact workings of your  game. Overhead is the extra data that is sent every packet, and adds to  the required bandwidth. By sending more data per packet, the overhead  will make up a smaller part of the data sent.</p>
<h2><a class="header" href="#delayed-lockstep" id="delayed-lockstep">Delayed Lockstep</a></h2>
<p>Anyways, we explained the peer-to-peer part, but you’re probably  wondering what is deterministic lockstep. Gaffer on Games already wrote  about this in <a href="https://gafferongames.com/post/deterministic_lockstep/">an article you can read here</a>, but in summary.</p>
<p>At its very basics, lockstep works by collecting input from every  player and then simulating one frame once all input is gathered. In  other words, the only thing that gets transmitted between players is  their input. Input often can be packed into a single byte, and therefore very little bandwidth is required. When the input then arrives, the  simulation is advanced one step. Since everyone waits for input from  each other, everyone steps in sync.</p>
<p>But however small the packets are, the latency will remain largely  the same. To wait for every player to send their input each time would  mean that the game can not update faster than (in the best case) 1/RTT/2 Hz (confirmation can be sent later). If you want your game loop to run  at 60Hz, you can’t have an RTT over 30 ms which is difficult to achieve  outside of wired and geographically small networks.</p>
<p>Enter: Delayed Lockstep. The ”delay” part is an input buffer that  stores inputs for a short while before executing them. Now every input  packet also contains a frame timestamp so that all remote input can be  matched up with the local input and executed at the same frame. As input rolls in it is stored in the matching slot in a buffer, and by the time a frame should be simulated the corresponding buffer slot should be  filled with input from all players. The latest input is then popped off  the buffer, which shifts one frame forward, and the game progresses one  step. By maintaining this buffer (barring major interruptions) the game  always has input at hand, and can as soon and as quickly as it wants.  But as you might guess, there’s a tradeoff, and that is of course the  added delay. The remote players already have some delay so it doesn’t  matter too much, but the local input must be slowed down to match the  slowest player, leading to slower response to keyboard input. To  minimise this delay, the buffer should be as short as possible. To give  everyone’s input time to arrive the buffer must be as long as the  slowest players ping + their jitter. To improve the experience, your  networking should continually measure how long it is between the last  player’s input arriving and the buffer running out, and then adjusting  the buffer to be as short as possible. A too long buffer means  unnecessary input delay, but if the buffer is too short and runs out the game must freeze until input arrives. It’s a fine line to walk, but  it’s usually better to lean towards too long than having interruptions.</p>
<p>However, there’s one big, or rather HUGE, issue: Determinism. Since  all that is sent between clients is their inputs, one requirement must  be met. Given the same world state and inputs, every time, on every  computer, OS, architecture, instruction set, etc. etc. the game must be  able to generate the exact same next frame. The tiniest deviation  accumulates and quickly makes the game unplayable. The main source of  nondeterminism is floating point arithmetic. Performing operations with  floating point numbers famously produces varying results, which depends  on many factors. Random number generators must also be kept in sync.</p>
<p>We want to reduce the amount of data being sent online by each peer,  AND we don’t want to have people hack the game. The way to do this then, is to have players only send their inputs to each other, so that you  can’t have people change their position all willy nilly <a href="https://www.youtube.com/watch?v=yMVkh4BJe7k">like this</a>.</p>
<p>However, we want to make sure that when inputs are sent to each  player, the game itself is fully deterministic: the same thing must  happen with the same inputs every time to prevent clients from desyncing with each other. There’s a lot of ways to handle this that we not going to get into, but I’m sure could make for a very interesting separate  article.</p>
<p>For now, we are going to assume that the game itself is fully deterministic and just take a look at the code itself in <a href="https://github.com/fishfight/FishFight/blob/main/src/nodes/network.rs">src/nodes/network.rs</a>.</p>
<p>We are first going to take a look at the data being sent online, the  packets. In this case, the packets in network.rs are called messages,  which is what they are so it makes sense.</p>
<pre><pre class="playpen"><code class="language-rust">
<span class="boring">#![allow(unused_variables)]
</span><span class="boring">fn main() {
</span>#[derive(DeBin, SerBin)]
enum Message {
    Input {
        // position in the buffer
        pos: u8,
        // current simulation frame
        frame: u64,
        input: Input,
    },
    Ack {
        // last simulated frame
        frame: u64,
        /// bitmask for last 8 frames
        /// one bit - one received input in a frames_buffer
        ack: u8,
    },
}
<span class="boring">}
</span></code></pre></pre>
<p>Each message has two different parts to it. It has an Input struct,  which contains the position in the input buffer, the frame that the game is currently on, and the actual input. It also has an Ack struct (which is sent to assure the other clients they received their input) that  contains the frame the game is on. The Ack struct also has a bitflag  that tells what inputs they got from what clients.</p>
<p>Now, the person reading this might wonder: why is there an input  buffer here? Well, we forgot to mention one thing. See, in the real  world, deterministic lockstep doesn’t actually work. Well, it doesn’t work the way you might think at first.</p>
<p>Every packet being sent online is always going to have a little bit  of delay to it (latency) since there is going to be some distance that  is covered by the packet as it travels. Even at the speed of light, it  still takes a nanosecond for a packet to get across from one side of the room to the other.</p>
<p>As such, if you were to have a naive interpretation of deterministic  lockstep without accounting for latency, it would just freeze every  single frame as it waits for inputs to appear.</p>
<p>This image taken from <a href="https://ki.infil.net/w02-netcode.html">Infil’s article about the netcode in Killer Instinct</a> (with permission!) should show what that looks like.</p>
<iframe src='https://gfycat.com/ifr/FaithfulImmaculateBug' frameborder='0' scrolling='no' allowfullscreen width='640' height='405'></iframe>
<p>(Note that this isn’t actually delay-based netcode either, but that’s a discussion for another time)</p>
<p>What instead is done is adding in an artificial delay to the program  itself, and having a buffer of input of a certain amount of frames. This allows the inputs time to arrive.</p>
<iframe src='https://gfycat.com/ifr/ActiveFormalAtlanticsharpnosepuffer' frameborder='0' scrolling='no' allowfullscreen width='640' height='405'></iframe>
<p>When the inputs come to the other players, it gets added into the  input buffer which also lasts a certain amount of frames. This means  that most moves and stuff feel noticeably slower with added delay.</p>
<iframe src='https://gfycat.com/ifr/AffectionateDescriptiveAiredaleterrier' frameborder='0' scrolling='no' allowfullscreen width='640' height='405'></iframe>
<hr />
<p>This concludes part 1 of our &quot;Netcode Explained&quot; series. In part 2 we will do a code walk-through and piecemeal analysis.</p>
<p><em>Written by Srayan “ValorZard” Jana and grufkok, with editing by Erlend</em></p>
<h1><a class="header" href="#editor" id="editor">Editor</a></h1>
<p>The editor is a tool for designing custom levels in Fish Fight. You can use it to examine and edit
existing levels, and also create your own.
This chapter will contain guides on how to use all of the features the editor has to offer and even a
high-level overview of its API for those who are interested in contributing to its development.</p>
<p><img src="./assets/editor.png" alt="Screenshot of the Fish Fight editor. The map area and layers toolbar are visible. Default textures for platforms occupy the map area." /></p>
<h2><a class="header" href="#accessing-the-editor" id="accessing-the-editor">Accessing the editor</a></h2>
<p>The editor can be accessed from the &quot;Editor&quot; tab on the main menu. Selecting this item by clicking on it, or using the right arrow key on your keyboard (or if you're using a gamepad: the &quot;right button&quot;), will present two options: &quot;Create Map&quot; and &quot;Load Map&quot;.</p>
<p><img src="./assets/editor_menu.png" alt="Screenshot of the main menu displaying options for the editor: &quot;create map&quot;, &quot;load map&quot;, and &quot;quit&quot;." /></p>
<h2><a class="header" href="#user-interface-overview" id="user-interface-overview">User-interface overview</a></h2>
<p>There are 3 main areas of the UI for designing your level: the <strong>tool selector</strong>, <strong>map</strong>, and <strong>layers list</strong>. Perhaps the most important area is the map as it acts as a preview of your level. The tool selector and layers list are available as toolbars that provide a set of tools for you to edit and examine your level as needed.</p>
<p><img src="./assets/editor_gui_highlights.png" alt="Screenshot of editor user interface with each major area highlighted." /></p>
<p><strong>Note: Icons are not yet available for the tool selector. The first one is the tile placement tool and the second is the eraser tool.</strong></p>
<h3><a class="header" href="#toolbars" id="toolbars">Toolbars</a></h3>
<p>There are currently 2 primary toolbars available for the editor: the layers list and tool selector.</p>
<h4><a class="header" href="#layers-list" id="layers-list">Layers list</a></h4>
<p>Create or edit layers of your Fish Fight level. This toolbar provides a list of selectable layers. Selecting a layer will display another view containing a list of the components grouped under that layer. There are currently 2 types of layers: tiles and objects:</p>
<p><strong>Tile layers</strong> contain textures that can be placed in the map area. They can be created to be collision layers as well, allowing them to behave like collidable objects.</p>
<p><strong>Object layers</strong> are composed of game objects categorized by a <code>MapObjectKind</code>. The current types of objects available are: <code>Item</code>, <code>SpawnPoint</code>, <code>Environment,</code> and <code>Decoration</code>.</p>
<h4><a class="header" href="#tool-selector" id="tool-selector">Tool selector</a></h4>
<p>As the name describes: provides a set of tools for editing layers in the map area of the editor. Currently, the following tools are available:</p>
<ul>
<li>Tile placement</li>
<li>Eraser</li>
</ul>
<h1><a class="header" href="#contributing-1" id="contributing-1">Contributing</a></h1>
<p>Fish Fight aims to be a highly contributor-friendly game. If you haven't already, please take some time to read the <a href="code_of_conduct.html">community guidelines</a>.</p>
<h4><a class="header" href="#a-hrefhttpsgithubcomfishfightfishfightissues124development-tracksa" id="a-hrefhttpsgithubcomfishfightfishfightissues124development-tracksa"><a href="https://github.com/fishfight/FishFight/issues/124">Development Tracks</a></a></h4>
<p>Our <em>Tracks</em> are ongoing projects with one or more leads. Some are permanent (e.g. Items or Editor) while others are temporary (e.g. Special Tiles or Physics). These are the recommended jumping-on points for new contributors.</p>
<h4><a class="header" href="#fields-of-contribution" id="fields-of-contribution">Fields of contribution</a></h4>
<p>Games are a synthesis of many different talents. Like most games, we're starting out code-heavy as we're building out the core functionality. Thanks to our deep focus on modding however, over time we expect contributions like level editing or pixel remixing to be even more plentiful and diverse than the field of coding.</p>
<h2><a class="header" href="#code-" id="code-">Code 💻</a></h2>
<p>If you're interested in making a change that will involve hacking on the game's source code, we have a quick reference on how to get started at <a href="./contributing_code.html">Contributing Code</a>!</p>
<p>Sub-tracks:</p>
<ul>
<li><a href="https://github.com/fishfight/FishFight/issues/129">Items</a></li>
<li><a href="https://github.com/fishfight/FishFight/issues/160">Level Editor</a></li>
<li><a href="https://github.com/fishfight/FishFight/issues/43">Special Tiles</a></li>
<li><a href="https://github.com/fishfight/FishFight/issues/120">Juicing</a></li>
<li><a href="https://github.com/fishfight/FishFight/issues/30">Physics</a> (parent track missing)</li>
<li><a href="https://github.com/fishfight/FishFight/issues/127">Infrastructure</a> (parent track missing)</li>
</ul>
<h2><a class="header" href="#pixels-" id="pixels-">Pixels 🎨</a></h2>
<p>There are three primary types of art assets in Fish Fight:</p>
<ul>
<li>Items</li>
<li>Tiles &amp; Objects</li>
<li>Characters</li>
</ul>
<p>Soon to be a proper book page:
https://cdn.discordapp.com/attachments/785221806214479872/899304557979504650/How_to_draw_a_weapon_the_Fish_Fight_way.pdf</p>
<p>Any of our items labeled <a href="https://github.com/fishfight/FishFight/labels/art-needed">art-needed</a> are missing an art asset.</p>
<h2><a class="header" href="#audio-" id="audio-">Audio 🎶</a></h2>
<h3><a class="header" href="#sfx" id="sfx">SFX</a></h3>
<p>Right now the easiest way in is to create new SFX for an <a href="https://github.com/fishfight/FishFight/labels/item">item</a>.</p>
<p>Prior art in https://github.com/fishfight/FishFight/tree/main/assets/sounds</p>
<h3><a class="header" href="#music-compositions" id="music-compositions">Music compositions</a></h3>
<p>Prior art in https://github.com/fishfight/FishFight/tree/main/assets/music</p>
<h2><a class="header" href="#game-design-" id="game-design-">Game Design 👾</a></h2>
<h3><a class="header" href="#items-1" id="items-1">Items</a></h3>
<p>See the <a href="https://github.com/fishfight/FishFight/issues/129">Items</a> track.</p>
<h3><a class="header" href="#levels" id="levels">Levels</a></h3>
<p>With the v1 completion of our upcoming <a href="https://github.com/fishfight/FishFight/issues/160">Level Editor</a>, it will be possible to create new levels from within the game itself.</p>
<h1><a class="header" href="#contributing-code-to-fish-fight" id="contributing-code-to-fish-fight">Contributing Code to Fish Fight</a></h1>
<p>Proposing code changes has 3 main steps:</p>
<ol>
<li>Setting up your development environment</li>
<li>Pick an issue to work on</li>
<li>Write code and submitting for review</li>
</ol>
<h2><a class="header" href="#1-setting-up-your-development-environment" id="1-setting-up-your-development-environment">1. Setting up your development environment</a></h2>
<h3><a class="header" href="#before-starting" id="before-starting">Before starting</a></h3>
<p>Make sure <a href="https://www.rust-lang.org/">Rust</a> is installed with <a href="https://rustup.rs/">Rustup.rs</a>.</p>
<p>Have an account on <a href="https://github.com/">GitHub</a>: this is where you'll find the <a href="https://github.com/fishfight/FishFight">source code</a> for Fish Fight.</p>
<h3><a class="header" href="#getting-the-source-code" id="getting-the-source-code">Getting the source code</a></h3>
<p>Fish Fight uses <a href="https://git-scm.com/">git</a> as its established choice of version control. You'll be
using it to clone, track, and manage the source code locally on your machine.</p>
<p>To get a copy of the code, you'll first need to <a href="https://docs.github.com/en/get-started/quickstart/fork-a-repo">fork the repository</a>.
The GitHub repository for Fight Fight is <a href="https://github.com/fishfight/FishFight">available here</a>.
This will allow you to make changes to the project without affecting the original one.</p>
<p>Once you've forked the Fish Fight repository, you can now clone it:</p>
<p><code>git clone https://github.com/YOUR_ACCOUNT_NAME/FishFight.git</code></p>
<p>It's also possible to clone the repo using SSH or GitHub CLI. For more information on how to do
this, see the <a href="https://docs.github.com/en/get-started/quickstart/fork-a-repo#cloning-your-forked-repository">official GitHub documentation</a>.</p>
<p>Depending on your connection, the clone can take around 1 minute.</p>
<p>By the end of this step, you should have successfully forked and downloaded a clone of Fish Fight on your machine.</p>
<h3><a class="header" href="#build-and-run" id="build-and-run">Build and run</a></h3>
<p>You can now build your forked copy of Fish Fight:</p>
<p><code>cargo build</code></p>
<p>This process should take about a minute or two depending on your machine. You can also <strong>build and run</strong> the game with a single command:</p>
<p><code>cargo run</code></p>
<h2><a class="header" href="#2-finding-a-good-first-issue" id="2-finding-a-good-first-issue">2. Finding a good first issue</a></h2>
<p>Now that you can build and run Fish Fight source code, let's find something to work on!
We recommend all newcomers start with our <a href="https://github.com/fishfight/FishFight/issues/124">Development Tracks</a>.
You can also browse <a href="https://github.com/fishfight/FishFight/issues">project's issues list</a> and pick something with a <a href="https://github.com/fishfight/FishFight/labels/help%20wanted">help wanted label</a>.
In general, you can comment on an issue expressing interest and someone will assign it to you.</p>
<p>Additionally, if there's a track or issue you're particularly interested in, but you don't know where to start, feel free to
reach out to the <a href="https://discord.gg/4smxjcheE5">Fish Fight Discord community</a> with your questions
and someone should reach out shortly!</p>
<h2><a class="header" href="#3-write-code-and-submitting-for-review" id="3-write-code-and-submitting-for-review">3. Write code and submitting for review</a></h2>
<p>In general, Fish Fight uses a branch-based workflow (or <a href="https://docs.github.com/en/get-started/quickstart/github-flow">GitHub flow</a>) for submitting changes to the project.</p>
<h3><a class="header" href="#create-a-new-branch" id="create-a-new-branch">Create a new branch</a></h3>
<p>You'll want to <a href="https://docs.github.com/en/get-started/quickstart/github-flow#create-a-branch">create a new branch</a> off <code>main</code>:</p>
<p><code>git checkout -b &lt;branch_name&gt; main</code></p>
<p>You'll replace <code>&lt;branch-name&gt;</code> with something short and descriptive. For example, if you're adding a new
item to Fish Fight, your branch name might look like this:</p>
<p><code>git checkout -b add_new_weapon main</code></p>
<h3><a class="header" href="#commit-your-changes" id="commit-your-changes">Commit your changes</a></h3>
<p>Once you've made the desired changes to the code and you're ready for someone on the Fish Fight
team to review, you need to <a href="https://git-scm.com/docs/git-commit">commit your work</a>. But first,
we have to run a few commands to ensure the code you're submitting is properly formatted:</p>
<ol>
<li><code>cargo clippy -- -W clippy::correctness -D warnings</code></li>
<li><code>cargo fmt</code></li>
</ol>
<p>Now we can start committing your work. First, stage your changes:
<code>git add</code></p>
<p>Now commit. It's always good practice to provide a short message that details what the changes are. For example:
<code>git commit -m &quot;Add a new weapon&quot;</code></p>
<h3><a class="header" href="#submitting-for-review" id="submitting-for-review">Submitting for review</a></h3>
<p>You can now start submitting your work for review. First, push your changes:</p>
<p><code>git push</code></p>
<p>This will create a new branch on your forked copy of Fish Fight. You can then proceed <a href="https://docs.github.com/en/desktop/contributing-and-collaborating-using-github-desktop/working-with-your-remote-repository-on-github-or-github-enterprise/creating-an-issue-or-pull-request#creating-a-pull-request">making a pull request</a>.
This is how the Fish Fight team will review and provide feedback on your work.</p>
<p><a href="https://docs.github.com/en/desktop/contributing-and-collaborating-using-github-desktop">More information on contributing using GitHub</a>.</p>
<h1><a class="header" href="#simple-gun-weapon" id="simple-gun-weapon">Simple Gun Weapon</a></h1>
<p>This section will walk through the process of adding a new gun weapon to Fish Fight, using a sniper weapon as an example.</p>
<h2><a class="header" href="#planning" id="planning">Planning</a></h2>
<p>Before jumping into the games code, it is a good idea to do some planning about what you want your new weapon to do. I determined that my sniper weapon should have the following properties:</p>
<ul>
<li>High bullet speed</li>
<li>Large recoil</li>
<li>2 bullets</li>
</ul>
<h2><a class="header" href="#implementation" id="implementation">Implementation</a></h2>
<p>Open your cloned &quot;FishFight&quot; directory using your code editor of choice.</p>
<h3><a class="header" href="#the-item-definition" id="the-item-definition">The item definition</a></h3>
<p>To add an item or, in this case, a weapon to the game, you will first have to define the item in a data file. These files are located in
<code>assets/items</code> and will typically have the same name as the item's id. Since we are creating a sniper rifle, we can give this file the 
name <code>sniper_rifle.json</code>. This path to the file must also be added to the file <code>assets/items.json</code>, so that game will know where to look
for it. This is done by simply adding the path to the file, relative to the <code>items.json</code> file, to the array within. In this case, the path
that we add will be <code>items/sniper_rifle.json</code>.</p>
<p>Now, it is time to define the weapons parameters inside the <code>items.json</code> file. Begin by creating a new object and adding
the id (<code>sniper_rifle</code>) and the item type (<code>weapon</code>).</p>
<p>Every item that we add will also need a set of sprite parameters (<code>SpriteParams</code>) that define the sprite that will be drawn
when the item is on the ground, before being picked up by the player. Typically, it will be enough to include a texture id here,
as things like sprite size will most often be defined in the texture's entry in the <code>assets/textures.json</code> file.</p>
<p>We will also need to define a collider size, that will be the size of the collider used when checking if a player is close enough
to the item to pick it up:</p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;sniper_rifle&quot;,
  &quot;type&quot;: &quot;weapon&quot;,
  &quot;sprite&quot;: {
    &quot;texture&quot;: &quot;musket&quot;
  },
  &quot;collider_size&quot;: {
    &quot;x&quot;: 16,
    &quot;y&quot;: 16
  }
}
</code></pre>
<p>That is all the required data for the item part of our definition, so now it is time need to add the parameters required for weapon item variants.</p>
<p>We have quite a few options for customization here that can be explored by looking at the <code>WeaponParams</code> struct in the source code. We are required 
to define at least the <code>ActiveEffectParams</code>, which holds the parameters of the effect that will be instantiated when the weapon is used to attack,
and a <code>WeaponAnimationParams</code>, which holds the parameters of the animation players that will be used to animate and draw the weapon when it is
equipped. We also wanted our rifle to have two bullets and a heavy recoil, so we should also define these parameters. We should also specify a
cooldown for our weapon, which governs the interval between shots, and an attack duration, which controls the length of time that the player is
locked in the attack state (input blocked), after an attack. We should also add a sound effect, to be played when the weapon is used. We will also
have to add an effect offset, which is the offset from the weapons position to the point where the weapons effect will originate.</p>
<p>Now, it is time to define the parameters for the affect that will be instantiated when we fire the gun. There are several variants to
choose from, or a new one can be implemented, either as a new variant of <code>ActiveEffectKind</code> or as an implementation of the <code>WeaponEffectCoroutine</code>
type. In our case, however, there is already a perfect fit; the <code>Projectile</code> variant.</p>
<p>We will want to specify a projectile speed, a projectile range and a specification for how the projectile should be drawn. A projectile can be
drawn as a simple colored shape or using a texture. We will use a texture and we will also color the projectile by setting a tint:</p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;sniper_rifle&quot;,
  &quot;type&quot;: &quot;weapon&quot;,
  &quot;sprite&quot;: {
    &quot;texture&quot;: &quot;musket&quot;
  },
  &quot;uses&quot;: 2,
  &quot;cooldown&quot;: 1.5,
  &quot;attack_duration&quot;: 1.0,
  &quot;recoil&quot;: 1400.0,
  &quot;sound_effect&quot;: &quot;shoot&quot;,
  &quot;collider_size&quot;: {
    &quot;x&quot;: 64,
    &quot;y&quot;: 24
  },
  &quot;effect_offset&quot;: {
    &quot;x&quot;: 64,
    &quot;y&quot;: 16
  },
  &quot;effects&quot;: {
    &quot;type&quot;: &quot;projectile&quot;,
    &quot;projectile&quot;: {
      &quot;type&quot;: &quot;sprite&quot;,
      &quot;sprite&quot;: {
        &quot;texture&quot;: &quot;small_projectile&quot;,
        &quot;size&quot;: {
          &quot;x&quot;: 8,
          &quot;y&quot;: 4
        },
        &quot;tint&quot;: {
          &quot;r&quot;: 0.9,
          &quot;g&quot;: 0.75,
          &quot;b&quot;: 0.12,
          &quot;a&quot;: 1.0
        }
      }
    },
    &quot;range&quot;: 600.0,
    &quot;speed&quot;: 25.0
  },
  &quot;animation&quot;: {
    &quot;texture&quot;: &quot;musket&quot;,
    &quot;animations&quot;: [
      {
        &quot;id&quot;: &quot;idle&quot;,
        &quot;row&quot;: 0,
        &quot;frames&quot;: 1,
        &quot;fps&quot;: 1
      },
      {
        &quot;id&quot;: &quot;attack&quot;,
        &quot;row&quot;: 1,
        &quot;frames&quot;: 3,
        &quot;fps&quot;: 15
      }
    ]
  },
  &quot;effect_animation&quot;: {
    &quot;texture&quot;: &quot;musket&quot;,
    &quot;animations&quot;: [
      {
        &quot;id&quot;: &quot;attack_effect&quot;,
        &quot;row&quot;: 2,
        &quot;frames&quot;: 4,
        &quot;fps&quot;: 12
      }
    ]
  }
}
</code></pre>
<h2><a class="header" href="#texture" id="texture">Texture</a></h2>
<p>It is important to make sure that your weapon is able to be visually distinguished between the other weapons in the game. When I added the sniper rifle to the <code>ITEMS</code> array, I copied all of the data from existing musket weapon, changing only the <code>tiled_name</code> and <code>constructor</code>. To give my sniper weapon a new texture, I will also need to change the <code>gun</code> texture in the <code>textures</code> field. Currently, the <code>gun</code> texture is set to <code>assets/Whale/Gun(92x32).png</code>. I'll open this file with my pixel editor of choice, <a href="https://www.aseprite.org/">Aseprite</a> (<a href="https://www.gimp.org/">GIMP</a> would also work fine).</p>
<p><img src="assets/open_gun_texture.png" alt="open_gun_texture" /></p>
<p>I don't consider myself an artist so I'm just going to modify the hue of the golden part of the gun texture to a reddish color. First I'll select a color range and adjust the threshold to select only the golden part of the gun texture.</p>
<p><img src="assets/select_gun_colors.png" alt="select_gun_colors" /></p>
<p>Then I'll adjust the hue of the selected colors to turn all of the gold color red.</p>
<p><img src="assets/adjust_gun_hue.png" alt="adjust_gun_hue" /></p>
<p>This texture is now distinguishable from the other gun textures in the game.</p>
<p>This, of course, is just one way of distinguishing the texture from the other textures in the game. Feel free to copy and modify textures using your own methods, or if you feel inclined, make your own unique texture for your weapon!</p>
<p>Now, all that remains is to add the new texture to the game. This is done by copying the texture file to the <code>assets/textures/items</code> directory and adding an entry to the file <code>assets/textures.json</code>.</p>
<p>Assuming a texture file name of <code>SniperRifle(92x32).png</code>, the following entry should be added to <code>assets/textures.json</code>:</p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;sniper_rifle&quot;,
  &quot;path&quot;: &quot;textures/items/SniperRifle(92x32).png&quot;,
  &quot;type&quot;: &quot;spritesheet&quot;,
  &quot;sprite_size&quot;: {
    &quot;x&quot;: 92,
    &quot;y&quot;: 32
  }
}
</code></pre>
<p>You will also have to change your weapons data file, so that it references this new texture, in stead of <code>&quot;musket&quot;</code>. This is done by changing the <code>texture</code> fields of your weapons <code>sprite</code> and <code>animation</code> members to <code>&quot;sniper_rifle&quot;</code>.</p>
<h2><a class="header" href="#testing" id="testing">Testing</a></h2>
<p>The last thing we need to do is put our new weapon in the game and test it! Fish Fight's levels are defined in json files in the <code>assets/maps</code> directory. For testing items, there is a test level in the game defined in a file called <code>test_level.json</code>. Open this file.</p>
<p>In this file you will see a long list of item entries containing data about items that are placed in the level. The easiest way to add your new weapon to this level is to replace the <code>name</code> field of one of other items currently in the level with the id of your new weapon (referred to as <code>your_weapon</code> throughout this chapter). Here is the entry for my sniper weapon.</p>
<pre><code class="language-json">...
{
    &quot;draworder&quot;:&quot;topdown&quot;,
    &quot;id&quot;:5,
    &quot;name&quot;:&quot;items&quot;,
    &quot;objects&quot;:[
        ...
        {
            &quot;height&quot;:0,
            &quot;id&quot;:147,
            &quot;name&quot;:&quot;sniper&quot;,
            &quot;point&quot;:true,
            &quot;rotation&quot;:0,
            &quot;type&quot;:&quot;item&quot;,
            &quot;visible&quot;:true,
            &quot;width&quot;:0,
            &quot;x&quot;:400,
            &quot;y&quot;:690
        },
        ...
    ],
    ...
}
</code></pre>
<p>If you followed all of these steps correctly, your new weapon should be in the game. Run the game using <code>cargo run</code>, then select the test level. You should see your gun in the level and be able to try it out.</p>
<p><img src="assets/sniper_weapon_test.gif" alt="sniper_weapon_test" /></p>
<p>Now all you need to do is modify the values in <code>src/items/your_weapon.rs</code> until the weapon feels right to you! Then you are ready to make a pull request.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
